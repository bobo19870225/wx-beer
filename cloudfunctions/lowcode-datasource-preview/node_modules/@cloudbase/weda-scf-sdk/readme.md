# @cloudbase/weda-scf-sdk
微搭低码数据源为 tcb 云函数提供的 sdk, 可在tcb云函数中调用微搭数据源的方法

## 使用方法


### 初始化sdk `weda.init`
一般情况下, 微搭环境和当前云开发环境是同一个环境, 可以不用初始化, 但是如果不是同一个环境, 则需按下述步骤初始化:

```js
weda.init({
  env: 'lowcode-env-id',
  // 调用的数据源所属环境, 该值亦可以在调用数据源方法时单独指定
  //  可选值有 pre 预览环境, prod 发布环境
  // 默认为 发布环境 
  envType: 'pre',
})
```

注⚠️: 若调使用sdk的云开发环境和微搭环境不属于同一用户, sdk将无法调用微搭数据源方法


### 调用数据源方法
可以通过 `weda.callModel` 调用模型数据源方法, 通过 `weda.callConnector` 调用连接器方法

```js
const weda = require('@cloudbase/weda-scf-sdk')

exports.main = async (event, context) => {
  /**
   * 若微搭环境和当前云开发环境不是同一个环境
   *  则需要使用 weda.init 方法来指定微搭环境id
   */
  // weda.init({env: 'weda-env-id'})
  // 调用连接器
  const docs = await weda.callConnector({
    name: 'docs_90gn9pp',
    methodName: 'getSheets',
    params: {bookID: 'BB3JwRGJxdnVhSGpk'},
  })
  // 调用数据模型
  const users = await weda.callModel({
    name: 'users_wegn2ix',
    methodName: 'wedaGetList',
  })
  return {
    docs,
    users
  }
};
```

`weda.callModel` 和 `weda.callConnector` 参数说明

```ts
export interface IParams {
  /**
   * 数据源标识
   */
  name: string
  /**
   * 方法名称
   */
  methodName: string
  /**
   * 方法参数
   *  各个模块均需要参数, 参数根据调用的方法而异, 部分方法不需要参数
   */
  params?: any
  /**
   * 调用的引用环境类型, 默认值为 'prod'
   *  pre: 预览环境
   *  prod: 正式环境
   */
  envType?: 'pre' | 'prod'
}
```
