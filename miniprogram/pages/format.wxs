function format(ts, option) {
    ts = ts || "";
    var date = getDate(ts);
    var year = date.getFullYear()
    var month = date.getMonth() + 1
    var day = date.getDate()
    var week = date.getDay()
    var hour = date.getHours()
    var minute = date.getMinutes()
    var second = date.getSeconds()

    if (option == 'deadline') {
        var now = getDate();
        var oneDay = 24 * 60 * 60 * 1000; // 一个自然日的毫秒数
        var yearDiff = date.getFullYear() - now.getFullYear();
        var monthDiff = date.getMonth() - now.getMonth();
        var dayDiff = date.getDate() - now.getDate();
        var totalDiff = yearDiff * 365 + monthDiff * 30 + dayDiff; // 计算完整年份和不满一年的天数差异
        if (totalDiff > 0) {
            if (totalDiff < 3) {
                return '即将过期'
            }
            return totalDiff + '天后过期'
        } else {
            return '已过期'
        }
    }

    if (option == 'pastTime') {
        var now = getDate();
        var oneMinute = 60 * 1000; // 1分钟的毫秒数
        var diff = Math.abs(date.getTime() - now.getTime()); // 计算两个日期的时间差（毫秒）
        var minute = Math.floor(diff / oneMinute);
        return minute == 0 ? '刚刚' : minute + '分钟前'; // 将时间差转换为分钟并向下取整
    }

    //获取 年月日
    if (option == 'YY-MM-DD') return [year, month, day].map(formatNumber).join('-')

    //获取 年月
    if (option == 'YY-MM') return [year, month].map(formatNumber).join('-')

    //获取 年
    if (option == 'YY') return [year].map(formatNumber).toString()

    //获取 月
    if (option == 'MM') return [mont].map(formatNumber).toString()

    //获取 日
    if (option == 'DD') return [day].map(formatNumber).toString()

    //获取 年月日 周一 至 周日
    if (option == 'YY-MM-DD Week') return [year, month, day].map(formatNumber).join('-') + ' ' + getWeek(week)

    //获取 月日 周一 至 周日
    if (option == 'MM-DD Week') return [month, day].map(formatNumber).join('-') + ' ' + getWeek(week)

    //获取 周一 至 周日
    if (option == 'Week') return getWeek(week)

    //获取 时分秒
    if (option == 'hh-mm-ss') return [hour, minute, second].map(formatNumber).join(':')

    //获取 时分
    if (option == 'hh-mm') return [hour, minute].map(formatNumber).join(':')

    //获取 分秒
    if (option == 'mm-dd') return [minute, second].map(formatNumber).join(':')

    //获取 时
    if (option == 'hh') return [hour].map(formatNumber).toString()

    //获取 分
    if (option == 'mm') return [minute].map(formatNumber).toString()

    //获取 秒
    if (option == 'ss') return [second].map(formatNumber).toString()

    //默认 时分秒 年月日
    return [year, month, day].map(formatNumber).join('-') + ' ' + [hour, minute, second].map(formatNumber).join(':')
}

function formatNumber(n) {
    n = n.toString()
    return n[1] ? n : '0' + n
}

function getWeek(n) {
    switch (n) {
        case 1:
            return '星期一'
        case 2:
            return '星期二'
        case 3:
            return '星期三'
        case 4:
            return '星期四'
        case 5:
            return '星期五'
        case 6:
            return '星期六'
        case 7:
            return '星期日'
    }
}

function formatMoney(val) {
    if (!val) {
        return val
    }
    return val.toFixed(2)
}

module.exports.format = format
module.exports.formatMoney = formatMoney